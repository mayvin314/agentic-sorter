import streamlit as st
import pandas as pd
from docx import Document
from PyPDF2 import PdfReader
from fuzzywuzzy import fuzz

def extract_text_from_docx(file):
    doc = Document(file)
    return " ".join(para.text for para in doc.paragraphs)

def extract_text_from_pdf(file):
    reader = PdfReader(file)
    text = []
    for page in reader.pages:
        extracted = page.extract_text()
        if extracted:
            text.append(extracted)
    return " ".join(text)

def evaluate_resume(text, checklist):
    score = 0
    for keyword in checklist:
        if fuzz.partial_ratio(keyword.lower(), text.lower()) > 80:
            score += 1
    return score

st.title("ðŸ“„ Resume Sorting Assistant")

checklist_file = st.file_uploader("Upload Checklist (Excel)", type=["xlsx"])
resume_files = st.file_uploader("Upload Resumes (PDF/DOCX)", type=["pdf", "docx"], accept_multiple_files=True)

if checklist_file and resume_files:
    df = pd.read_excel(checklist_file)
    checklist_keywords = df.iloc[:, 0].dropna().astype(str).tolist()

    st.write("### Checklist Keywords")
    st.write(checklist_keywords)

    results = []

    for resume in resume_files:
        if resume.name.lower().endswith(".pdf"):
            text = extract_text_from_pdf(resume)
        elif resume.name.lower().endswith(".docx"):
            text = extract_text_from_docx(resume)
        else:
            continue

        score = evaluate_resume(text, checklist_keywords)
        decision = "Use" if score >= len(checklist_keywords) // 2 else "Do Not Use"

        results.append({
            "File Name": resume.name,
            "Score": score,
            "Decision": decision
        })

    results_df = pd.DataFrame(results)

    st.write("### Resume Evaluation Results")
    st.dataframe(results_df)

    csv = results_df.to_csv(index=False).encode("utf-8")
    st.download_button("Download Results as CSV", data=csv, file_name="resume_evaluation_results.csv", mime="text/csv")
streamlit
pandas
python-docx
PyPDF2
fuzzywuzzy
openpyxl